var JSON;if(!JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());(function(f){var b=false,e=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;var c=function(){};c.extend=function(k){var j=this.prototype;b=true;var i=new this();b=false;for(var h in k){i[h]=typeof k[h]=="function"&&typeof j[h]=="function"&&e.test(k[h])?(function(l,m){return function(){var o=this._super;this._super=j[l];var n=m.apply(this,arguments);this._super=o;return n}})(h,k[h]):k[h]}function g(){if(!b&&this.init){this.init.apply(this,arguments)}}g.prototype=i;g.prototype.constructor=g;g.extend=c.extend;return g};var d={debug:false,trace:function(g){if(this.debug&&f.console!==undefined){f.console.log("Porthole: "+g)}},error:function(g){if(typeof f.console!==undefined&&typeof f.console.error==="function"){f.console.error("Porthole: "+g)}}};d.WindowProxy=function(){};d.WindowProxy.prototype={post:function(h,g){},addEventListener:function(g){},removeEventListener:function(g){}};d.WindowProxyBase=c.extend({init:function(g){if(g===undefined){g=""}this.targetWindowName=g;this.origin=f.location.protocol+"//"+f.location.host;this.eventListeners=[]},getTargetWindowName:function(){return this.targetWindowName},getOrigin:function(){return this.origin},getTargetWindow:function(){return d.WindowProxy.getTargetWindow(this.targetWindowName)},post:function(h,g){if(g===undefined){g="*"}this.dispatchMessage({data:h,sourceOrigin:this.getOrigin(),targetOrigin:g,sourceWindowName:f.name,targetWindowName:this.getTargetWindowName()})},addEventListener:function(g){this.eventListeners.push(g);return g},removeEventListener:function(h){var g;try{g=this.eventListeners.indexOf(h);this.eventListeners.splice(g,1)}catch(i){this.eventListeners=[]}},dispatchEvent:function(h){var g;for(g=0;g<this.eventListeners.length;g++){try{this.eventListeners[g](h)}catch(j){d.error(j)}}}});d.WindowProxyLegacy=d.WindowProxyBase.extend({init:function(g,h){this._super(h);if(g!==null){this.proxyIFrameName=this.targetWindowName+"ProxyIFrame";this.proxyIFrameLocation=g;this.proxyIFrameElement=this.createIFrameProxy()}else{this.proxyIFrameElement=null;d.trace("proxyIFrameUrl is null, window will be a receiver only");this.post=function(){throw new Error("Receiver only window")}}},createIFrameProxy:function(){var g=document.createElement("iframe");g.setAttribute("id",this.proxyIFrameName);g.setAttribute("name",this.proxyIFrameName);g.setAttribute("src",this.proxyIFrameLocation);g.setAttribute("frameBorder","1");g.setAttribute("scrolling","auto");g.setAttribute("width",30);g.setAttribute("height",30);g.setAttribute("style","position: absolute; left: -100px; top:0px;");if(g.style.setAttribute){g.style.setAttribute("cssText","position: absolute; left: -100px; top:0px;")}document.body.appendChild(g);return g},dispatchMessage:function(h){var g=f.encodeURIComponent;if(this.proxyIFrameElement){var i=this.proxyIFrameLocation+"#"+g(d.WindowProxy.serialize(h));this.proxyIFrameElement.setAttribute("src",i);this.proxyIFrameElement.height=this.proxyIFrameElement.height>50?50:100}}});d.WindowProxyHTML5=d.WindowProxyBase.extend({init:function(g,h){this._super(h);this.eventListenerCallback=null},dispatchMessage:function(g){this.getTargetWindow().postMessage(d.WindowProxy.serialize(g),g.targetOrigin)},addEventListener:function(h){if(this.eventListeners.length===0){var g=this;if(f.addEventListener){this.eventListenerCallback=function(i){g.eventListener(g,i)};f.addEventListener("message",this.eventListenerCallback,false)}else{if(f.attachEvent){this.eventListenerCallback=function(i){g.eventListener(g,f.event)};f.attachEvent("onmessage",this.eventListenerCallback)}}}return this._super(h)},removeEventListener:function(g){this._super(g);if(this.eventListeners.length===0){if(f.removeEventListener){f.removeEventListener("message",this.eventListenerCallback)}else{if(f.detachEvent){if(typeof f.onmessage==="undefined"){f.onmessage=null}f.detachEvent("onmessage",this.eventListenerCallback)}}this.eventListenerCallback=null}},eventListener:function(h,g){var i=d.WindowProxy.unserialize(g.data);if(i&&(h.targetWindowName===""||i.sourceWindowName==h.targetWindowName)){h.dispatchEvent(new d.MessageEvent(i.data,g.origin,h))}}});if(!f.postMessage){d.trace("Using legacy browser support");d.WindowProxy=d.WindowProxyLegacy.extend({})}else{d.trace("Using built-in browser support");d.WindowProxy=d.WindowProxyHTML5.extend({})}d.WindowProxy.serialize=function(g){if(typeof JSON==="undefined"){throw new Error("Porthole serialization depends on JSON!")}return JSON.stringify(g)};d.WindowProxy.unserialize=function(i){if(typeof JSON==="undefined"){throw new Error("Porthole unserialization dependens on JSON!")}try{var g=JSON.parse(i)}catch(h){return false}return g};d.WindowProxy.getTargetWindow=function(g){if(g===""){return parent}else{if(g==="top"||g==="parent"){return f[g]}}return f.frames[g]};d.MessageEvent=function a(i,g,h){this.data=i;this.origin=g;this.source=h};d.WindowProxyDispatcher={forwardMessageEvent:function(k){var i,j=f.decodeURIComponent,h,g;if(document.location.hash.length>0){i=d.WindowProxy.unserialize(j(document.location.hash.substr(1)));h=d.WindowProxy.getTargetWindow(i.targetWindowName);g=d.WindowProxyDispatcher.findWindowProxyObjectInWindow(h,i.sourceWindowName);if(g){if(g.origin===i.targetOrigin||i.targetOrigin==="*"){g.dispatchEvent(new d.MessageEvent(i.data,i.sourceOrigin,g))}else{d.error("Target origin "+g.origin+" does not match desired target of "+i.targetOrigin)}}else{d.error("Could not find window proxy object on the target window")}}},findWindowProxyObjectInWindow:function(g,j){var h;if(g){for(h in g){if(Object.prototype.hasOwnProperty.call(g,h)){try{if(g[h]!==null&&typeof g[h]==="object"&&g[h] instanceof g.Porthole.WindowProxy&&g[h].getTargetWindowName()===j){return g[h]}}catch(k){}}}}return null},start:function(){if(f.addEventListener){f.addEventListener("resize",d.WindowProxyDispatcher.forwardMessageEvent,false)}else{if(f.attachEvent&&f.postMessage!=="undefined"){f.attachEvent("onresize",d.WindowProxyDispatcher.forwardMessageEvent)}else{if(document.body.attachEvent){f.attachEvent("onresize",d.WindowProxyDispatcher.forwardMessageEvent)}else{d.error("Cannot attach resize event")}}}}};if(typeof exports!=="undefined"){module.exports=d}else{f.Porthole=d}})(typeof window!=="undefined"?window:this);var SSO_HOST="https://konto.tvn.pl";var SSO_STATIC_HOST="//s-konto.cdntvn.pl";var SSO_IS_OAUTH=false;var SSO_DEBUG=false;function ssoDebug(a){if(SSO_DEBUG){console.log(a)}}var Sso={frameProxy:"/iframe-proxy.html",registerUrl:"/zarejestruj,popup.html",registerPlayerUrl:"/zarejestruj,player-popup.html",registerFacebookPlayerUrl:"/zarejestruj,facebook,player-popup.html",activateUrl:"/profil,aktywacja,[code],popup.html",activateSocialUrl:"/profil,aktywacja,[code],social,popup.html",activatePlayerUrl:"/profil,aktywacja,[code],player-popup.html",authLogoutUrl:"/wyloguj,popup.html",authLogoutPlayerUrl:"/wyloguj,player-popup.html",authLoginUrl:"/zaloguj,popup.html",authLoginPlayerUrl:"/zaloguj,player-popup.html",changePasswordUrl:"/zmien-haslo,popup.html",changePasswordPlayerUrl:"/zmien-haslo,player-popup.html",rememberPasswordUrl:"/przypomnij-haslo,popup.html",rememberPasswordPlayerUrl:"/przypomnij-haslo,player-popup.html",lostPasswordUrl:"/zmiana-hasla,popup,[code]",lostPasswordPlayerUrl:"/zmiana-hasla,player-popup,[code]",profilUrl:"/profil.html",loginBarUrl:"/user/login-bar.json",rulesUrl:"/regulamin,popup,1.html",ncplusPlayerUrl:"/ncplus,player-popup.html",isLoggedUser:false,getLoggedUser:null,isInit:false,isSafari:false,visitTvn:false,callbackFunctiones:{},callbackFunction:null,loginFrameOpened:false,isLoginFrameOpenedFromForum:false,isPlayer:false,init:function(){if(this.isInit){return}this.isSafari=((typeof navigator!="undefined")&&(typeof navigator.userAgent!="undefined")&&/Safari/.test(navigator.userAgent)&&!/chrome/.test(navigator.userAgent.toLowerCase()));this.isInit=true;this.activateWindowProxy();this.activateAccountListener();this.addOtherEvents();this.addOpenFrameEvents();this.addCloseFrameEvents();this.loginUser();$(window).resize(function(){$(".ssoFrame").addClass("resize");setTimeout(function(){$(".ssoFrame").removeClass("resize")},100)});if(this.isSafari){this.visitTvn=this.checkVisitTvn()}if(!this.isPlayer){(function(){var a=document.getElementsByTagName("head")[0];var b=document.createElement("link");b.rel="stylesheet";b.type="text/css";b.href=SSO_STATIC_HOST+"/css/sso_desktop.css";b.media="all";a.appendChild(b)})()}if($.browser.msie&&parseInt($.browser.version,10)<9){(function(){var a=document.getElementsByTagName("head")[0];var b=document.createElement("link");b.rel="stylesheet";b.type="text/css";b.href=SSO_STATIC_HOST+"/css/sso_desktop_ie.css";b.media="all";a.appendChild(b)})()}},setPlayer:function(){this.isPlayer=true},checkVisitTvn:function(){if(jQuery.cookie("visitTvn")){return true}var b=new RegExp(".tvn.pl$");var a=b.exec(window.location.host.toString());if(a){jQuery.cookie("visitTvn",true);return true}return false},checkSafariBehavior:function(a){if(Sso.isSafari&&!a&&!jQuery.cookie("sso_safari_behavior")){jQuery.cookie("sso_safari_behavior",1);window.location.href=SSO_HOST+"/player,safariBehavior.html?p="+window.location.pathname}},isRequiredRenewCookie:function(){return((typeof SSO_PORTAL_RENEW_COOKIE!=="undefined")&&SSO_PORTAL_RENEW_COOKIE)?true:false},isExistsRenewCookie:function(){return jQuery.cookie("tvn_renew_cookie")?true:false},activateWindowProxy:function(){windowProxy=new Porthole.WindowProxy(SSO_HOST+this.frameProxy);windowProxy.addEventListener(this.onFrameMessage)},activateAccountListener:function(){var b=this.getPopupSrcSso();if(b){var a="activateFrame";this.createFrame(b,a);window.location.hash=""}},onFrameMessage:function(d){if(d&&d.data&&d.data.action){var p=d.data.action;switch(p){case"unload":ssoDebug(p+" iframe event was called.");$(".ssoFrame").addClass("resize");break;case"new_height":ssoDebug(p+" iframe event was called.");var b=d.data.options;if(!Sso.isPlayer){$(".ssoFrame").height(b.height+"px")}else{$(".ssoFrame").addClass("ssoFrame-playerplus")}$(".ssoFrame iframe").height(b.height+"px");$(".ssoFrame").removeClass("resize");break;case"resize":ssoDebug(p+" iframe event was called.");var b=d.data.options;if(!Sso.isPlayer){var n=b.width;if(b.device&&b.device!="Desktop"){var o=$(window).width();if(screen&&screen.width){o=screen.width}if(n>o){n=o}}$(".ssoFrame").width((n)+"px");$(".ssoFrame").height((b.height)+"px");$(".ssoFrame iframe").width((n)+"px")}else{$(".ssoFrame").addClass("ssoFrame-playerplus");$(".ssoFrame").css({width:"",height:""})}$(".ssoFrame iframe").height((b.height)+"px");$(".ssoFrame").removeClass("resize");if(b.isNotification){$(".ssoFrame").addClass("ssoFrame-playerplus-notification")}else{$(".ssoFrame").removeClass("ssoFrame-playerplus-notification")}break;case"loggedout":ssoDebug(p+" iframe event was called.");SsoEventTracking.sendSsoEvent("Logout","Wyloguj","__GET_FROM_COOKIE__");document.location="/";try{if(localStorage.getItem("sso_additional_data")){localStorage.removeItem("sso_additional_data")}}catch(s){$.cookie("sso_additional_data",null,{path:"/"})}break;case"loggedoutTmobile":ssoDebug(p+" iframe event was called.");if(typeof SsoEventTracking!="undefined"){SsoEventTracking.sendSsoEvent("Logout","Wyloguj","__GET_FROM_COOKIE__")}tmobileLoggoutUser();break;case"logged":ssoDebug(p+" iframe event was called.");Sso.loginUser();break;case"errorFrame":ssoDebug(p+" iframe event was called.");$(".ssoFrame").width("600px");$(".ssoFrame iframe").width("600px");if(Sso.isPlayer){$(".ssoFrame").addClass("ssoFrame-playerplus")}windowProxy.post({action:"errorFrameConfirmation"});break;case"close":ssoDebug(p+" iframe event was called.");$(".ssoFrame").fadeOut();$(".ssoFrameBackground").remove();break;case"closeAndRedirectToHomePage":ssoDebug(p+" iframe event was called.");$(".ssoFrame").fadeOut();$(".ssoFrameBackground").remove();window.location.href="/";break;case"offClose":ssoDebug(p+" iframe event was called.");$("div.ssoFrame a.closeButton").remove();$(".ssoFrameBackground").unbind();break;case"offSubmitForm":ssoDebug(p+" event was called.");var a=$("div.ssoFrame a.closeButton");$(".ssoFrame a.closeButton").die("click");a.unbind("click");a.click(function(){windowProxy.post({action:"confirmRulesForm"})});break;case"adapter":ssoDebug(p);var b=d.data.options;var h=document.createElement("iframe");var u=Math.floor((Math.random()*9999)+1);h.name="setadapter"+u;h.src="javascript:false";h.width=0;h.height=0;document.body.appendChild(h);var t=document.createElement("form");t.action=b.url;t.method="post";t.target="setadapter"+u;document.body.appendChild(t);$(t).submit();break;case"adapterSelf":ssoDebug(p+" iframe event was called.");try{var m=d.data.options.url;var i=window.location.host.match("[a-z0-9]*.[a-z]*$");if("tvn.pl"===i.toString()){return}var f=m.match("^https://konto.([a-z]*.pl)");if(typeof f[1]!="undefined"){m=m.replace(f[1],i.toString());m=m.replace(f[1],i.toString());m=m.replace("konto","sso");m+="&rand="+Math.round(Math.random()*100000).toString();var k=new Image();k.src=m}}catch(c){}break;case"event":ssoDebug(p+" iframe event was called.");var b=d.data.options;try{if(b.event){if(b.action){SsoEventTracking.sendSsoEvent(b.param,b.event,b.action)}else{SsoEventTracking.sendSsoEvent(b.param,b.event)}}if(b.param==="AfterSsoRegister"&&typeof sendEventForPickGTMWhenUserRegister=="function"){sendEventForPickGTMWhenUserRegister()}}catch(s){}break;case"loggedAndSendNumberPhone":ssoDebug(p+" iframe event was called.");if(d.data.options&&d.data.options.numberPhone&&d.data.options.numberPhone.length===9){if(typeof loggedAndSendNumberPhoneCallback==="function"){loggedAndSendNumberPhoneCallback(d.data.options.numberPhone)}}break;case"refreshPopupAfterLogin":ssoDebug(p+" iframe event was called.");if(typeof refreshPopupAfterLoginCallback==="function"){refreshPopupAfterLoginCallback()}break;case"loggedUserAfterRegister":ssoDebug(p+" iframe event was called.");if(typeof loggedUserAfterRegisterCallback==="function"){loggedUserAfterRegisterCallback()}break;case"closeActivePopupAndOpenLoginFrame":ssoDebug(p+" iframe event was called.");if(typeof closeActivePopupAndOpenLoginFrame==="function"){var g=(d.data.options&&d.data.options.numberPhone)?d.data.options.numberPhone:"";closeActivePopupAndOpenLoginFrame(g)}break;case"sendNumberPhoneToPlayer":ssoDebug(p+" iframe event was called.");if(typeof sendNumberPhoneToPlayer==="function"){var g=(d.data.options&&d.data.options.numberPhone)?d.data.options.numberPhone:"";sendNumberPhoneToPlayer(g)}break;case"resizeIframe":ssoDebug(p+" iframe event was called.");if(typeof resizeIframe==="function"){var j=(d.data.options&&d.data.options.height)?d.data.options.height:"";resizeIframe(j);ssoDebug(p+" iframe event was called.")}else{ssoDebug("resizeIframe is not defined.")}break;case"firstPage":ssoDebug(p+" iframe event was called.");if(typeof firstPage==="function"){var q=(d.data.options&&d.data.options.flag)?d.data.options.flag:"";firstPage(q);ssoDebug(p+" iframe event was called.")}else{ssoDebug("firstPage is not defined.")}break;case"passElementNameFromSSO":ssoDebug(p+" iframe event was called.");if(typeof passElementNameFromSSO==="function"){var l=(d.data.options&&d.data.options.id)?d.data.options.id:"";passElementNameFromSSO(l);ssoDebug(p+" iframe event was called.")}else{ssoDebug("passElementNameFromSSO is not defined.")}break;case"userRegistered":h=document.createElement("iframe");h.style.display="none";h.src=d.data.registeredUrl;$(".ssoFrame").append(h);break;case"ncplusRegistered":selectEshopPackage();break;case"scrollTop":ssoDebug("scrollTop action was called.");$("html, body").animate({scrollTop:0},300);break;case"scrollTo":var r=0;if(d.hasOwnProperty("data")&&d.data.hasOwnProperty("options")&&d.data.options.hasOwnProperty("height")){r=d.data.options.height}ssoDebug("scrollTo action was called.");$("html, body").animate({scrollTop:r},300);break;case"scrollTopNoAnimate":ssoDebug("scrollTopNoAnimate action was called.");$(window).scrollTop(0);break;case"checkSafariBehavior":Sso.checkSafariBehavior(d.data.status);break;default:ssoDebug(p+" iframe event not exists");break}}},getPopupSrcSso:function(){if(typeof window.location.hash=="string"){var c=new RegExp("^#(sso|socialsso|playersocialsso|playersso|przypomnijplayer|przypomnijhaslo|zaloguj|zarejestrujprzezfb|zarejestrujstandard|playerzaloguj|tmobilezaloguj)(.*)");var b=c.exec(decodeURIComponent(window.location.hash.toString()));if(b){switch(b[1]){case"sso":return SSO_HOST+this.activateUrl.replace("[code]",b[2]);break;case"socialsso":case"playersocialsso":return SSO_HOST+this.activateSocialUrl.replace("[code]",b[2]);break;case"playersso":return SSO_HOST+this.activatePlayerUrl.replace("[code]",b[2]);break;case"przypomnijhaslo":var a=this.lostPasswordUrl.replace("[code]",b[2]);return SSO_HOST+a;break;case"przypomnijplayer":var a=this.lostPasswordUrl.replace("[code]",b[2]);return SSO_HOST+a;break;case"zaloguj":return SSO_HOST+this.authLoginUrl;break;case"zarejestrujprzezfb":return SSO_HOST+this.registerFacebookPlayerUrl;break;case"zarejestrujstandard":return SSO_HOST+this.registerPlayerUrl;break;case"playerzaloguj":return SSO_HOST+this.authLoginPlayerUrl;break;case"tmobilezaloguj":return openRegisterAndVerificationNumberTmobile();break}}}return null},createFrame:function(a,c,g){if(typeof g=="undefined"){g=false}var b=document.createElement("div");b.className="ssoFrameBackground";var d=document.createElement("div");d.className="ssoFrame resize";if(Sso.isPlayer){d.className+=" ssoFrame-playerplus"}if($(".ssoFrame")){$(d).width($(".ssoFrame").width());$(d).height($(".ssoFrame").height())}var e=document.createElement("a");e.className="closeButton";e.href="#";e.textContent="X";d.appendChild(e);if(g){$(e).click(function(){document.location.reload()})}var h=document.createElement("div");$(h).attr("id","loadFrameDiv");$(h).attr("class","ssoFrameLoader");d.appendChild(h);var i=document.createElement("div");$(i).attr("class","ssoFrameWrapper");d.appendChild(i);var f=document.createElement("iframe");f.src=a+((a.split("?").length>1)?"&":"?")+"portalhash="+SSO_PORTAL_HASH;f.name=c;f.frameborder="0";$(".ssoFrameBackground").remove();$(".ssoFrame").remove();i.appendChild(f);$("body").append(b).append(d);if(g){$(".ssoFrameBackground").click(function(){document.location.reload()})}else{$(".ssoFrameBackground").click(function(){$(".ssoFrame").fadeOut();$(".ssoFrameBackground").remove()})}$("html, body").scrollTop(0);return d},createFrameInVisible:function(d,b){$(".ssoFrame").remove();var a=document.createElement("div");a.className="ssoFrame ssoFrameInVisible";var c=document.createElement("iframe");c.src=d;c.name=b;c.frameborder="0";a.appendChild(c);$("body").append(a);return a},createFrameStaticContent:function(f,c){$(".ssoFrameBackground").remove();$(".ssoFrame").remove();var e="";e+="<h3>"+f+"</h3>";e+='<div class="section">'+c+"</div>";e+='<div class="fancyBoxBottom"></div>';var b=document.createElement("div");b.className="ssoFrameBackground";var a=document.createElement("div");a.className="ssoFrame ssoFrameStatic";var d=document.createElement("div");$(d).attr("class","ssoFrameWrapper ssoFrameWrapperStatic");a.appendChild(d);d.innerHTML='<a class="closeButton" href="#">X</a>'+e;$("body").append(b).append(a);$("html, body").scrollTop(0);wraperWidth=$(d).width();$(a).width(wraperWidth);$(a).height($(d).height());return a},addOpenFrameEvents:function(){$("a[data-frameurl]").live("click",function(f){f.preventDefault();f.stopPropagation();if(!Sso.isPlayer&&(window.isMobileDevice||($.browser.msie&&parseInt($.browser.version,10)<9))){var g=$(this).data("frameurl");var d=g.toString().replace(/[,-]popup/gi,"");var a="";if(/loginUri=/.test(d)){d=d.replace(/loginUri=[^&]/gi,"loginUri=standard")}else{d+=((d.split("?").length>1)?"&":"?")+"loginUri=standard"}if(window.isMobileDevice){a=window.location.pathname}document.location=d+((d.split("?").length>1)?"&":"?")+"portalhash="+SSO_PORTAL_HASH+"&returnPath="+a;return false}var g=$(this).data("frameurl");var b=$(this).data("frameclass");var c=$(this).data("framecallbackkey");Sso.checkIfLoginFrameHasBeenOpenedFromForum(f);Sso.openLoginFrameByParams(g,b,c);return false})},checkIfLoginFrameHasBeenOpenedFromForum:function(a){try{if($(a.target).closest("#forum").length){this.isLoginFrameOpenedFromForum=true}}catch(b){}},addOtherEvents:function(){$("a[href^='"+SSO_HOST+Sso.profilUrl+"']").live("click",function(a){$(this).attr("target","_blank");return true})},checkIsFromPlayer:function(){if(typeof SSO_PORTAL_HASH!=="undefined"){if(SSO_PORTAL_HASH==="ccde4ea49c1018f36588bf0ecb78ab98"){return true}}return false},forceReloadLogoutForPlayer:function(b){if(true===this.checkIsFromPlayer()){var a=b.parent().children(".ssoFrameWrapper").find("iframe").attr("src");if(-1!==a.indexOf("wyloguj")){document.location="/"}}},addCloseFrameEvents:function(){var a=this;$(".ssoFrame a.closeButton").live("click",function(){$(".ssoFrame, .ssoFrameBackground").remove();a.forceReloadLogoutForPlayer($(this));return false})},openLoginFrameByParams:function(a,c,f,e){Sso.clearCallbackFunction();this.loginFrameOpened=true;if(typeof e!=="string"){e=null}if(($.browser.msie&&parseInt($.browser.version,10)<9)){var d=a.toString().replace(/,player-popup|,popup/gi,"");var b=d+((a.split("?").length>1)?"&":"?")+"portalhash="+SSO_PORTAL_HASH;if(e&&(typeof encodeURIComponent==="function")){b+="&returnPath="+encodeURIComponent(e)}document.location=b;return false}if((typeof f==="string")&&f){Sso.addCallbackFunction(f)}if((typeof c==="undefined")||!c){c="defaultFrame"}a=Sso.getAndAddBrandingClassFromBody(a);if(typeof TvnEventTracking!=="undefined"&&TvnEventTracking){TvnEventTracking.track(["AuthFrame"],{ipresso:{event:"showAuthForm"}})}Sso.createFrame(a,c)},openLoginFrame:function(b,a){if(typeof a!=="string"){a=null}if(typeof b==="function"){Sso.registerCallbackFunction("___DEFAULT___",b);b="___DEFAULT___"}else{if(typeof b!=="string"){b=null}}Sso.openLoginFrameByParams(SSO_HOST+Sso.authLoginUrl,"loginFrame",b,a)},openPlayerLoginFrame:function(b,a){if(typeof a!=="string"){a=null}if(typeof b==="function"){Sso.registerCallbackFunction("___DEFAULT___",b);b="___DEFAULT___"}else{if(typeof b!=="string"){b=null}}Sso.openLoginFrameByParams(SSO_HOST+Sso.authLoginPlayerUrl,"loginFrame",b,a)},openPlayerLoginFrameForTMobile:function(b,a){if(typeof a!=="string"){a=null}if(typeof b==="function"){Sso.registerCallbackFunction("___DEFAULT___",b);b="___DEFAULT___"}else{if(typeof b!=="string"){b=null}}Sso.openLoginFrameByParams(SSO_HOST+Sso.authLoginPlayerUrl+"?loginForOrder=1","loginFrame",b,a)},openPlayerNcplusLoginFrame:function(b,a){if(typeof a!=="string"){a=null}if(typeof b==="function"){Sso.registerCallbackFunction("___DEFAULT___",b);b="___DEFAULT___"}else{if(typeof b!=="string"){b=null}}Sso.openLoginFrameByParams(SSO_HOST+Sso.authLoginPlayerUrl+"?ncpluscontext=1","loginFrame",b,a)},openPlayerNcplusRegisterFrame:function(b,a){if(typeof a!=="string"){a=null}if(typeof b==="function"){Sso.registerCallbackFunction("___DEFAULT___",b);b="___DEFAULT___"}else{if(typeof b!=="string"){b=null}}Sso.openLoginFrameByParams(SSO_HOST+Sso.ncplusPlayerUrl,"loginFrame",b,a)},registerCallbackFunction:function(a,b){Sso.callbackFunctiones[a]=b},addCallbackFunction:function(a){if(typeof Sso.callbackFunctiones[a]==="function"){Sso.callbackFunction=a}},clearCallbackFunction:function(){Sso.callbackFunction=null},callCallbackFunction:function(b){if((typeof Sso.callbackFunction==="string")&&(typeof Sso.callbackFunctiones[Sso.callbackFunction]==="function")){var a=Sso.callbackFunctiones[Sso.callbackFunction];a(b)}Sso.clearCallbackFunction()},isLocalStorage:function(){try{return"localStorage" in window&&window.localStorage!==null}catch(a){return false}},getStorageData:function(){try{if(this.isLocalStorage()&&window.localStorage.getItem("tvn_id")!==null){return window.localStorage.getItem("tvn_id")}}catch(a){}return false},getStorageUserHash:function(){if(this.isLoggedUser&&this.getLoggedUser){return this.getLoggedUser.getUserHash()}else{if(this.getStorageData()){return this.getStorageData()}else{return""}}},addUserHashToStorage:function(b){try{if(this.isLocalStorage()&&b){localStorage.setItem("tvn_id",b)}}catch(a){return false}},loginUser:function(){this.isLoggedUser=false;this.getLoggedUser=null;var i=jQuery.cookie("sso_session_is_logged")?true:false;var b=jQuery.cookie("sso_data_cookie")?true:false;var c=false;if(SSO_IS_OAUTH===true){ssoDebug("loginUser: is OAuth flow");var d=jQuery.cookie("oauth_is_logged")?true:false;if(true===i&&false===d){var a=$("#userBar .loginLink").attr("href");if(a==="undefined"||!a){throw new Error("Missing OAuth authorization uri")}Sso.createFrameInVisible(a+"&bg_login=true","defaultFrame");ssoDebug("loginUser: createFrameInVisible done.");return}}var g=Sso.getLastChangeDataTime();var h=Sso.getLastUpdateDataTime();if((g&&!h)||(Math.round(Sso.getLastChangeDataTime())>Math.round(Sso.getLastUpdateDataTime()))){b=false;c=true}if(i&&b&&(!Sso.isRequiredRenewCookie()||Sso.isExistsRenewCookie())){if(this.isSafari&&!this.visitTvn){jQuery.cookie("visitTvn",true)}var f=jQuery.cookie("sso_data_cookie");f=JSON.parse(f);if(typeof f.user_hash==="string"){this.addUserHashToStorage(f.user_hash)}if(typeof f.name==="string"){f.name=f.name.replace(/\+/g," ")}if(typeof f.nick==="string"){f.nick=f.nick.replace(/\+/g," ")}var e=new SSOUser(f);Sso.isLoggedUser=true;Sso.getLoggedUser=e;$(window).trigger("user.logged",[e]);Sso.callCallbackFunction(e);Sso.sendAfterLoginEvent()}else{if(i||b){if(this.isSafari&&!this.visitTvn){jQuery.cookie("visitTvn",true)}$.get(this.loginBarUrl+((c)?"?refresh=1":""),function(k){if(k){if(k.rules_accepted==true){var j=new SSOUser(k);if(k.user_packages){try{localStorage.setItem("sso_additional_data",JSON.stringify(k.user_packages))}catch(l){$.cookie("sso_additional_data",JSON.stringify(k.user_packages,{path:"/"}))}}Sso.isLoggedUser=true;Sso.getLoggedUser=j;Sso.setLastUpdateDataTime(Math.floor(new Date()/1000));$(window).trigger("user.logged",[j]);Sso.callCallbackFunction(j);Sso.sendAfterLoginEvent();if(typeof k.user_hash==="string"){Sso.addUserHashToStorage(k.user_hash)}}else{Sso.createFrame(SSO_HOST+Sso.rulesUrl,"defaultFrame");var j=new User();$(window).trigger("user.logged",[j])}}else{var j=new User();$(window).trigger("user.logged",[j])}})}else{var e=new User();$(window).trigger("user.logged",[e])}}},getLastChangeDataTime:function(){var a=jQuery.cookie("sso_session_is_logged");if(a){var b=a.split("=");if(b.length>=3){return b[2]}}return null},getLastUpdateDataTime:function(){var a=jQuery.cookie("sso_session_update");return(a)?a:null},setLastUpdateDataTime:function(a){jQuery.cookie("sso_session_update",a)},pingLoginBarUrl:function(a){$.get(this.loginBarUrl,function(c){if(c&&(c.rules_accepted==true)){var b=new SSOUser(c);$(window).trigger("user.pingLoginBarRefresh",[b]);if(typeof a=="function"){a(b)}}})},userHasBeenLogout:function(){Sso.isLoggedUser=false;Sso.getLoggedUser=null;SsoEventTracking.sendSsoEvent("Logout","Wyloguj","__GET_FROM_COOKIE__");$(window).unbind("user.logged");$(window).bind("user.logged",function(d,c){document.location.reload()});var b="";b+="<h3>Twoja sesja wygasła, zaloguj się ponownie</h3>";b+='<div class="buttonContainer"><button>Zaloguj się</button></div>';var a=Sso.createFrameStaticContent("Upss...",b);$(a).find("button").click(function(){if(($.browser.msie&&parseInt($.browser.version,10)<9)||(Sso.isSafari&&!Sso.visitTvn)){var c=SSO_HOST+Sso.authLoginUrl;c=c.toString().replace(/,player-popup|,popup/gi,"");document.location=c+((c.split("?").length>1)?"&":"?")+"portalhash="+SSO_PORTAL_HASH+"&returnPath="+document.location.toString();return false}Sso.createFrame(SSO_HOST+Sso.authLoginUrl,"loginFrame",true);return false});$(a).find("a.closeButton").click(function(){var c=(typeof document.location.pathname!=="undefined")?document.location.pathname:"/";if(!c||(c=="/")){document.location.reload()}else{document.location="/"}return false})},checkUserHasBeenLogout:function(){if(jQuery.cookie("sso_session_is_logged")&&!jQuery.cookie("sso_data_cookie")){Sso.pingLoginBarUrl()}},sendAfterLoginEvent:function(){if(this.loginFrameOpened){SsoEventTracking.sendSsoEvent("AfterSsoLogin","Zalogowanie","__GET_FROM_COOKIE__")}},getAndAddBrandingClassFromBody:function(b){var a="branding-";var e=document.body.classList;for(var c=0;c<e.length;c++){if(e[c].indexOf(a)>-1){var d=e[c].replace(a,"");b=b+((b.split("?").length>1)?"&":"?")+"brandingClass="+d;return b}}return b}};User=function(a){this.authenticated=false;this.name="anonim.";this.data={nick:this.name,name:this.name,user_id:0,additional_params:null,user_hash:""}};User.prototype.isAuthenticated=function(){return this.authenticated};User.prototype.getNick=function(){return this.data.nick};User.prototype.getName=function(){return this.data.name};User.prototype.getUserHash=function(){return this.data.user_hash};User.prototype.getId=function(){return parseInt(this.data.user_id)};User.prototype.getAdditionalParams=function(){try{return JSON.parse(this.data.additional_params)}catch(a){return null}};User.prototype.getAvatar=function(a){switch(a){case 30:return SSO_STATIC_HOST+"/img/avatar_default_small.png";break;case 54:return SSO_STATIC_HOST+"/img/avatar_default.png";break;default:return SSO_STATIC_HOST+"/img/avatar_default_small.png"}};User.prototype.getIsMarketingAgreement=function(){return this.data.marketing_agreement};User.prototype.getTmplData=function(){if(typeof this.data.tmpl==="object"){return this.data.tmpl}return{}};User.prototype.isTmplFullVerified=function(){var a=this.getTmplData();if((typeof a.full_verified!=="undefined")&&a.full_verified){return true}return false};User.prototype.isTmplVerified=function(){var a=this.getTmplData();if((typeof a.verified!=="undefined")&&a.verified){return true}return false};User.prototype.getTmplMsisdnHash=function(){var a=this.getTmplData();if((typeof a.msisdn_hash!=="undefined")&&a.msisdn_hash){return a.msisdn_hash}return null};SSOUser=function(a){this.data=a;this.authenticated=true};SSOUser.prototype=new User();SSOUser.prototype.getAvatar=function(b){var a=null;switch(b){case 30:a=this.data.avatar_url;break;case 54:a=this.data.avatar_url54;break}if(!a){if((typeof this.data.avatar_fb_url!=="undefined")&&this.data.avatar_fb_url){a=this.data.avatar_fb_url}else{switch(b){case 30:a=SSO_STATIC_HOST+"/img/avatar_default_small.png";break;case 54:a=SSO_STATIC_HOST+"/img/avatar_default.png";break;default:a=SSO_STATIC_HOST+"/img/avatar_default_small.png"}}}return a};var ssoEventTracking=function(){this.siteName=document.location.host;this.lastEvent="";this.lastAction=""};ssoEventTracking.prototype.getSiteName=function(){return window.location.host+this.getSiteSpecialSection(true)};ssoEventTracking.prototype.getSiteSpecialSection=function(a){a=a||false;var b="";if(window.location.pathname.indexOf("/t-mobile/")>-1){b+=a?"/t-mobile":"t-mobile"}else{if(window.location.pathname.indexOf("/icc/")>-1){b+=a?"/icc":"icc"}}return b};ssoEventTracking.prototype.getLoginTypeFromCookie=function(){var b="standard";if(jQuery&&jQuery.cookie){if(jQuery.cookie("sso_login_type")){b=jQuery.cookie("sso_login_type")}}else{var a=this.getCookieByName("sso_login_type");if(a){b=a}}return b};ssoEventTracking.prototype.isUserLogged=function(){if(typeof(TvnUserUtils)!="undefined"&&TvnUserUtils.getUser){var a=TvnUserUtils.getUser();if(a&&a.isAuthenticated){return a.isAuthenticated()}}return false};ssoEventTracking.prototype.getUserHash=function(){return Sso.getStorageUserHash()};ssoEventTracking.prototype.getCookieByName=function(a){var b="; "+document.cookie;var c=b.split("; "+a+"=");if(c.length==2){return c.pop().split(";").shift()}};ssoEventTracking.prototype.track=function(c,d){if(!(window.location.host.indexOf("tvn24")===0||window.location.host.indexOf("www.tvn24")===0)){this.sendGAEvent(c,d)}var b=this.getGemiusCode(c);if(b!==false){if(typeof gemius_event!=="undefined"){this.sendGemiusEvent(b,c,d)}else{function a(e){window[e]=window[e]||function(){var f=window[e+"_pdata"]=window[e+"_pdata"]||[];f[f.length]=arguments}}a("gemius_hit");a("gemius_event");a("pp_gemius_hit");a("pp_gemius_event");(function(k,h){try{var g=k.createElement(h),i=k.getElementsByTagName(h)[0],f="http"+((location.protocol=="https:")?"s":"");g.setAttribute("async","async");g.setAttribute("defer","defer");g.src=f+"://tvn.hit.gemius.pl/xgemius.js";i.parentNode.insertBefore(g,i)}catch(j){}})(document,"script");this.sendGemiusEvent(b,c,d)}}};ssoEventTracking.prototype.sendGAEvent=function(b,c){if(typeof c.GA!=="undefined"){var a=["_trackEvent"];if(typeof ga!=="undefined"){a=["send","event"];ga("set","dimension1",Sso.isLoggedUser?"Yes":"No");if(this.getUserHash()){ga("set","dimension2",this.getUserHash())}}for(key in c.GA){if(c.GA.hasOwnProperty(key)){if(key=="action"&&c.GA[key]=="__GET_FROM_COOKIE__"){a.push(this.getLoginTypeFromCookie())}else{a.push(c.GA[key])}}}if(typeof ga!=="undefined"){ga.apply(undefined,a)}else{if(typeof _gaq!=="undefined"&&typeof _gaq.push=="function"){_gaq.push(["_setCustomVar",1,"logged_user",(Sso.isLoggedUser)?"Yes":"No"]);_gaq.push(a)}}}};ssoEventTracking.prototype.sendGemiusEvent=function(b,d,e){var c=this;var a=["_view_",b];for(key in e.gemius){if(e.gemius.hasOwnProperty(key)){if(key=="login_type"&&e.gemius[key]=="__GET_FROM_COOKIE__"){a.push(key+"="+c.getLoginTypeFromCookie())}else{a.push(key+"="+e.gemius[key])}}}a.push("logged_user="+((Sso.isLoggedUser)?"Yes":"No"));if(this.getUserHash()){a.push("id="+this.getUserHash())}gemius_event.apply(undefined,a)};ssoEventTracking.prototype.getGemiusCode=function(a){var c={Sso:{OpenSsoLogin:"11OVfWtViY6G62qEmsurqsdRTF5YlSx9X23sqzuOXvb.H7",AfterSsoLogin:"bV2bGQO55DsSjoOdt3ZvVqbS7FSI7mxPv1fsC_ti11T.m7",LoginError:"bPc7_QOn1DoSWpOtN7y.zfWo7FSF4GxPGjbsjdwjL0L.f7",Logout:"bV01XQO5eY0cqXqUx8ozM6bSTF6I7ix99eYMNOayl_v.67",AfterSsoRegister:"1vM1v2rledPActqP8ZLDUqdy7OqILmxDvx5GRGuUb5D.p7",OpenSsoRegister:"1_01X2tDeVQg.q._yTgW0KbS7FSI7mxPlULsjW6eL0L.q7",OpenSsoLoginButtonNoAds:"bV2bGQO55Dsc.4OdR8Pn9vVmXkGFLEcSGu4pjNw4NDj..7",AfterSsoLoginButtonNoAds:"1_2VfWtDiY3AKGqEcUOroqe0.jiI4obk9Wkp7OamXHn.g7",AfterSsoRegisterButtonNoAds:"1_01XWtDeY0me3qUMgYzsvTG.jiF7Ibk5CUpbuGHBIT.E7",OpenSsoRegisterButtonNoAds:"1007_Wuz1Dog9JOtSVn356cUXkGIokcSX8hJFZs2HBD.97",OpenSsoLoginBuyPackage:"102VH2uzidUgjmnREQkrUvTG.q6F7IbI5Du.KuDWGaP.A7",AfterSsoLoginBuyPackage:"bP01XwNJeVS809p.N4JLcPWoTBSF4CyB5KgMX_GrFx7.27",OpenSsoRegisterBuyPackage:"bP01vwNJedQS.nnD.9czevWo.hiF4IbUREK.3Ym88P3.G7",AfterSsoRegisterBuyPackage:"1vObG2rl5AIg.iOPkdVHUabSXmGI7kci9eX.jb4mcVv.V7",OpenSsoLoginForum:"bP01vQNJeQ28yaBvfzeWLvUI7MqFoGwzegnsagQzV8z.D7",AfterSsoLoginForum:"102bGWuz5DsgVOluyaYSOKe0TBSI4iyBv9tmjENlh_H.w7",OpenSsoRegisterForum:"102buWuz5Lsm0ekeskCax6e0.q6I4obIX26fcnMp2QL.D7",AfterSsoRegisterForum:"1007_Wuz1Dogjrk4ySfah.TGTBSF7CyBejbsWIRRX2f.q7"}};var b=c;for(var d in a){if(b.hasOwnProperty(a[d])){b=b[a[d]]}}if(typeof b=="string"){return b}return false};ssoEventTracking.prototype.sendSsoEvent=function(i,d,f,a){var f=f||"__GET_FROM_COOKIE__";var a=a||"";var c=this.getSiteSpecialSection();var h=this.getSiteName();try{if(this.lastEvent!=d||(this.lastEvent==d&&this.lastAction!=f)){var b=$("body").data("sso-event-override");if(typeof b!=="undefined"&&b){if($.isArray(b)){$.each(b,function(e,j){if(j.overriddenParam==i){i=j.param;d=j.event;a=j.label}})}$("body").data("sso-event-override",null)}if(Sso.isLoginFrameOpenedFromForum&&this.getGemiusCode(["Sso",i+"Forum"])){i+="Forum";a+="Forum"}a=a&&c?a+" "+c:a+c;this.track(["Sso",i],{gemius:{site_action:d,login_type:f,site_name:h},GA:{category:d,action:f,label:a}});this.lastEvent=d;this.lastAction=f}}catch(g){}};window.SsoEventTracking=new ssoEventTracking();